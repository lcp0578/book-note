## 第4章 存储高性能
- 关系数据库
	- 读写分离
	- 分库分表
		- 业务分库
			- join操作问题
			- 事务问题
			- 成本问题
		- 分表
			- 垂直分表
			- 水平分表
	- 实现方法
		- 程序代码封装
		- 中间件封装
- NoSQL	
	- 常见的NoSQL方案有如下4类：
		- K-V存储：解决关系数据库无法存储数据结构的问题，以Redis为代表。
		- 文档数据库：解决关系数据库强schema约束的问题，以MongoDB为代表。
		- 列式数据库：解决关系数据库大数据场景下的I/O问题，以HBase为代表。
		- 全文搜索引擎：解决关系数据库的全文搜索性能问题，以ElasticSearch为代表。
	- K-V存储
		- Redis的缺点主要体现在并不支持完整的ACID事务，Redis虽然提供事务功能，但Redis的事务和关系数据库的事务不可同日而语，Redis的事务只能保证隔离性和一致性（I和C），无法保证原子性和持久性（A和D）。
			- 原子性
				- Redis事务不支持原子性，Redis不支持回滚操作，事务中间一条命令执行失败，即不会导致前面已经执行的命令被回滚，也不会中断后面的命令的执行。
			- 一致性
				- Redis的事务能够保证事务开始之前喝事务结束以后，数据库的完整性没有被破坏。
			- 隔离性
				- Redis不存在多个事务的问题，因为Redis是单进程单线程的工作模式。这种隔离性的方式也会带来一个隐含的问题：如果某个客户端通过事务提交了大量的命令，那么会阻塞其他客户端进行任何操作。
			- 持久性
				- Redis提供两种持久化的方式，即RDB和AOF。
					- RDB持久化只备份当前内存中的数据，事务执行完毕时，其数据还在内存中，并未立即写入到磁盘，所以RDB持久化不能保证Redis事务的持久性。
					- AOF持久化是先执行命令，执行成功后再将命令追加到日志文件中。即使AOF每次执行命令后立刻将日志文件刷盘，也可能丢失1条命令的数据，因此AOF也不能严格保证Redis事务的持久性。
	- 文档数据库
		- 文档数据库的no-schema特性，给业务开发带来如下几个明显的优势
			- 新增字段简单
			- 历史数据不会出错
			- 可以很容易存储复杂数据
	- 列式数据库
		- 列式数据库就是按照列来存储数据的数据库。
		- 主要有如下几个优势
			- 业务同时读取多个列时效率高，因为这些列都是按行存储在一起的，一次磁盘操作就能够把一行数据中的各个列都读取到内存中。
			- 能够一次性完成对一行中的多个列的写操作。
	- 全文搜索引擎
		- 全文搜索引擎的技术原理被称为“倒排索引”(Inverted index)，也常被称为反向索引，其基本原理是建立单词到文档的索引。
- 缓存
	- 缓存穿透
		- 是指当业务系统查询的数据在存储系统中没有的时候，每次查询都会访问存储系统。
	- 缓存雪崩
		- 是指当缓存失效（过期）后引起系统性能急剧下降的情况。
	- 缓存热点
		- 指大部分甚至所有业务请求都命中同一份缓存数据。