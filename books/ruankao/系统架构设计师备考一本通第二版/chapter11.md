## 第11章 软件架构设计
#### 软件架构的概念
- 一个程序和计算机系统软件体系结构是指系统的一个或者多个结构。结构中包括软件的构件，构件的外部可见属性以及它们之间的相互关系。
- 软件体系结构设计的两个层次：
	- **数据设计**：体现传统系统中的体系结构的数据构件和面向对象系统中类的定义（封装了属性和操作）
	- **体系结构设计**：主要关注软件构件的结构、属性和交互作用。
- 软件架构设计与生命周期
	- （1）**需求分析阶段**。需求分析和SA（Software Architecture：软件架构）设计面临的是不同的对象：一个是问题空间；另一个是解空间。
	- （2）**设计阶段**。是SA研究关注的最早和最多的阶段，这一阶段的SA研究主要包括：SA模型的描述、SA模型的设计与分析方法，以及对SA设计经验的总结与复用等。
	- （3）**实现阶段**。最初SA研究往往只关注较高层次的系统设计、描述和验证。为了有效实现SA设计向实现的转换，实现阶段的体系结构研究表现在以下几个方面。
		- 1）研究基于SA的开发过程支持，如项目组织结构、配置管理等。
		- 2）寻求从SA向实现过渡的途径，如将程序设计语言元素引入SA阶段、模型映射、构件组装、复用中间件平台等。
	- （4）**构件组装阶段**。在SA设计模型的指导下，可复用构件的组装可以在较高层次上实现系统，并能够提高系统实现的效率。在构件组装的过程中，SA设计模型起到了系统蓝图的作用。研究内容包括如下两个方面：
		- 1）如何支持可复用构件互联，即对SA设计模型中的规约的连接子的实现提供支持。
		- 2）在组装过程中，如何检测并消除体系结构失配问题。
	- （5）**部署阶段**。SA对软件部署的作用如下：
		- 1）提供高层的体系结构视图来描述部署阶段的软硬件模型。
		- 2）基于SA模型可以分析部署方案的质量属性，从而选择合理的部署方案。
	- （6）**后开发阶段**。是指软件部署安装之后的阶段。这一阶段的SA研究主要围绕维护、演化、复用等方面来进行。典型的研究方向包括动态软件体系结构、体系结构恢复与重建等。

#### 构件
- 构件是一个独立可交付的功能单元，外界通过接口访问其提供的服务。
- 构件的特征：
	- ①独立部署单元
	- ②作为第三方的组装单元
	- ③没有（外部的）可见状态
- 构件技术
	- 国际上常用的构件标准主要有三大流派
		- EJB(Enterprise Java Bean)
		- COM/DCOM/COM+
		- CORBA

#### 软件架构风格
- 软件体系结构风格是藐视某一特定领域中系统组装方式的惯用模式。
- 架构风格汇总

<table>
	<tr>
		<th colspan="2">架构风格名</th>
		<th>常考关键字及实例</th>
		<th>简介</th>
	</tr>
	<tr>
		<td rowspan="2">数据流</td>
		<td>批处理</td>
		<td rowspan="2">传统编译器，每个阶段产生的结果作为狭义阶段的输入，区别在于整体</td>
		<td>一个接一个，以整体为单位</td>
	</tr>
	<tr>
		<td>管道-过滤器</td>
		<td>一个接一个，前一个的输出是后一个的输入</td>
	</tr>
	<tr>
		<td  rowspan="3">调用/返回</td>
		<td>主程序/子程序</td>
		<td></td>
		<td>显式调用，主程序直接调用子程序</td>
	</tr>
	<tr>
		<td>面向对象</td>
		<td></td>
		<td>对象是构件，通过对象调用封装的方法和属性</td>
	</tr>
	<tr>
		<td>层次结构</td>
		<td></td>
		<td>分层，每层最多影响其上下两层，有调用关系</td>
	</tr>
	<tr>
		<td rowspan="2">独立构件</td>
		<td>进程通信</td>
		<td></td>
		<td>进程间独立的消息传递，同步和异步方式</td>
	</tr>
	<tr>
		<td>事件驱动（隐式调用）</td>
		<td>事件触发推动动作，如程序语法的语法高亮、语法错误提示</td>
		<td>不直接调用，通过事件驱动</td>
	</tr>
	<tr>
		<td>虚拟机</td>
		<td>解释器</td>
		<td>自定义流程，按流程执行，规则随时改变，灵活定义，业务灵活组合机器人</td>
		<td>解释自定义的规则，解释引擎、存储区、数据结构</td>
	</tr>
	<tr>
		<td>规则系统</td>
		<td>规则集、规则解释器、选择器和工作内存，用于决策支持系统(DSS)和人工智能、专家系统</td>
	</tr>
	<tr>
		<td rowspan="3">仓库</td>
		<td>数据库</td>
		<td rowspan="3">现代编译器的集成开发环境（IDE），以数据为中心。又称为数据共享风格</td>
		<td>中央共享数据源，独立处理单元</td>
	</tr>
	<tr>
		<td>超文本</td>
		<td>网状链接，多用于互联网</td>
	</tr>
	<tr>
		<td>黑板</td>
		<td>语音识别、知识推理等问题复杂、解空间很大、求解过程不确定的这一类软件系统，黑板、知识源、控制</td>
	</tr>
	<tr>
		<td>闭环</td>
		<td>过程控制</td>
		<td>汽车巡航定速，空调温度调节，设定参数，并不断调整</td>
		<td>发出控制命令并接受反馈，循环往复达到平衡</td>
	</tr>
	<tr>
		<td colspan="2">C2</td>
		<td>构件和连接件、顶部和底部</td>
		<td>通过连接件绑定在一起按照一组规则运作的并行构件网络</td>
	</tr>